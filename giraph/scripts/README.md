## Giraph Benchmark Scripts

### Global configuration
Edit the ./config.sh file to setup the configuration variables

### Graphalytics configuration

1. Edit the following lines in ./config/benchmark.properties:

```sh
# Root directory containing graphs on local filesystem
graphs.root-directory = 

# Directory to cache derived datasets in (optional, defaults to ${graphs.root-directory}/cache)
graphs.cache-directory =  

# Directory to the validation datasets on local filesystem
graphs.validation-directory =  

# Directory to the output datasets generated by the system.
graphs.output-directory =  
```

2. Edit the following lines in ./config/platform.properties:

```sh
# Root directory of Hadoop framework, i.e. HADOOP_HOME (required)
platform.hadoop.home: 
```

3. Edit the following lines in ./config/benchmarks/custom.properties:

```sh
# Select a subset of the graphs
#e.g. com-friendster, datagen-9_0-fb
benchmark.custom.graphs = 

# Select a subset of the algorithms
benchmark.custom.algorithms = 
#bfs, cdlp, lcc, pr, wcc, sssp
```

### Hadoop configuration

1. Edit the following properties in ./hadoop/core-site.xml

```sh
  <property>
    <name>fs.defaultFS</name>
    <value>hdfs://sith1-fast:9000</value>
  </property>

  <property>
    <name>hadoop.tmp.dir</name>
    <value>/spare/manosanag/giraph/hadoop</value> <!-- Must be in datasets directory -->
  </property>
```

2. Add your slave machine in ./hadoop/slaves

3. Edit the following properties in ./hadoop/yarn-site.xml

```sh
	<property>
		<name>yarn.resourcemanager.scheduler.address</name>
		<value>sith1-fast:8030</value>
	</property>

	<property>
		<name>yarn.resourcemanager.address</name>
		<value>sith1-fast:8050</value>
	</property>

	<property>
		<name>mapreduce.map.env</name>
    <value>LD_LIBRARY_PATH=/opt/manosanag/teraheap/allocator/lib:$LD_LIBRARY_PATH</value>
	</property>
```

### Zookeeper configuration

1. Edit the following lines in ./conf/zoo.cfg

```sh
# Must be "$DATASET_DIR"/../zookeeper
# the directory where the snapshot is stored.
# do not use /tmp for storage, /tmp here is just 
# example sakes.
dataDir=/spare/manosanag/zookeeper 
```

### Download Dataset
```sh
./download-graphalytics-data-sets.sh /path/to/locate/dataset
```

### Add optional JVM flags

You can find the JVM flags in ./scripts/run.sh and edit them.

### Run Giraph with TeraHeap
```sh
./run.sh -n 1 -o "nvme" -t
```
### Run Giraph natively
```sh
./run.sh -n 1 -o "nvme" -t
```
